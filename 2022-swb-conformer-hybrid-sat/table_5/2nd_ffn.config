#!rnn.py

def summary(name, x):
  """
  :param str name:
  :param tf.Tensor x: (batch,time,feature)
  """
  from returnn.tf.compat import v1 as tf
  # tf.summary.image wants [batch_size, height,  width, channels],
  # we have (batch, time, feature).
  img = tf.expand_dims(x, axis=3)  # (batch,time,feature,1)
  img = tf.transpose(img, [0, 2, 1, 3])  # (batch,feature,time,1)
  tf.summary.image(name, img, max_outputs=10)
  tf.summary.scalar("%s_max_abs" % name, tf.reduce_max(tf.abs(x)))
  mean = tf.reduce_mean(x)
  tf.summary.scalar("%s_mean" % name, mean)
  stddev = tf.sqrt(tf.reduce_mean(tf.square(x - mean)))
  tf.summary.scalar("%s_stddev" % name, stddev)
  tf.summary.histogram("%s_hist" % name, tf.reduce_max(tf.abs(x), axis=2))

def _mask(x, batch_axis, axis, pos, max_amount):
  """
  :param tf.Tensor x: (batch,time,feature)
  :param int batch_axis:
  :param int axis:
  :param tf.Tensor pos: (batch,)
  :param int|tf.Tensor max_amount: inclusive
  """
  from returnn.tf.compat import v1 as tf
  ndim = x.get_shape().ndims
  n_batch = tf.shape(x)[batch_axis]
  dim = tf.shape(x)[axis]
  amount = tf.random_uniform(shape=(n_batch,), minval=1, maxval=max_amount + 1, dtype=tf.int32)
  pos2 = tf.minimum(pos + amount, dim)
  idxs = tf.expand_dims(tf.range(0, dim), 0)  # (1,dim)
  pos_bc = tf.expand_dims(pos, 1)  # (batch,1)
  pos2_bc = tf.expand_dims(pos2, 1)  # (batch,1)
  cond = tf.logical_and(tf.greater_equal(idxs, pos_bc), tf.less(idxs, pos2_bc))  # (batch,dim)
  if batch_axis > axis:
      cond = tf.transpose(cond)  # (dim,batch)
  cond = tf.reshape(cond, [tf.shape(x)[i] if i in (batch_axis, axis) else 1 for i in range(ndim)])
  from TFUtil import where_bc
  x = where_bc(cond, 0.0, x)
  return x

def random_mask(x, batch_axis, axis, min_num, max_num, max_dims):
  """
  :param tf.Tensor x: (batch,time,feature)
  :param int batch_axis:
  :param int axis:
  :param int|tf.Tensor min_num:
  :param int|tf.Tensor max_num: inclusive
  :param int|tf.Tensor max_dims: inclusive
  """
  from returnn.tf.compat import v1 as tf
  n_batch = tf.shape(x)[batch_axis]
  if isinstance(min_num, int) and isinstance(max_num, int) and min_num == max_num:
      num = min_num
  else:
      num = tf.random_uniform(shape=(n_batch,), minval=min_num, maxval=max_num + 1, dtype=tf.int32)
  # https://github.com/tensorflow/tensorflow/issues/9260
  # https://timvieira.github.io/blog/post/2014/08/01/gumbel-max-trick-and-weighted-reservoir-sampling/
  z = -tf.log(-tf.log(tf.random_uniform((n_batch, tf.shape(x)[axis]), 0, 1)))
  _, indices = tf.nn.top_k(z, num if isinstance(num, int) else tf.reduce_max(num))
  # indices should be sorted, and of shape (batch,num), entries (int32) in [0,dim)
  # indices = tf.Print(indices, ["indices", indices, tf.shape(indices)])
  if isinstance(num, int):
      for i in range(num):
          x = _mask(x, batch_axis=batch_axis, axis=axis, pos=indices[:, i], max_amount=max_dims)
  else:
      _, x = tf.while_loop(
          cond=lambda i, _: tf.less(i, tf.reduce_max(num)),
          body=lambda i, x: (
              i + 1,
              tf.where(
                  tf.less(i, num),
                  _mask(x, batch_axis=batch_axis, axis=axis, pos=indices[:, i], max_amount=max_dims),
                  x)),
          loop_vars=(0, x))
  return x

def transform(data, network, time_factor=1):
  x = data.placeholder
  from returnn.tf.compat import v1 as tf
  # summary("features", x)
  step = network.global_train_step
  step1 = tf.where(tf.greater_equal(step, 1000), 1, 0)
  step2 = tf.where(tf.greater_equal(step, 2000), 1, 0)
  def get_masked():
      x_masked = x
      x_masked = random_mask(
        x_masked, batch_axis=data.batch_dim_axis, axis=data.time_dim_axis,
        min_num=step1 + step2, max_num=tf.maximum(tf.shape(x)[data.time_dim_axis] // 100, 2) * (1 + step1 + step2 * 2),
        max_dims=20 // time_factor)
      x_masked = random_mask(
        x_masked, batch_axis=data.batch_dim_axis, axis=data.feature_dim_axis,
        min_num=step1 + step2, max_num=2 + step1 + step2 * 2,
        max_dims=data.dim // 5)
      #summary("features_mask", x_masked)
      return x_masked
  x = network.cond_on_train(get_masked, lambda: x)
  return x


adam = True
batch_size = 14000
batching = 'sort_bin_shuffle:.64'
cache_size = '0'
chunking = '500:250'
cleanup_old_models = {'keep': [60, 80, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300]}
dev = { 'class': 'MetaDataset',
  'data_map': { 'accent_label': ('accent_label', 'data'),
                'classes': ('dev_hdf', 'classes'),
                'data': ('dev_hdf', 'data'),
                'gender_label': ('gender_label', 'data'),
                'speaker_label': ('speaker_label_dev', 'data')},
  'datasets': { 'accent_label': { 'class': 'HDFDataset',
                                  'files': ['/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/accent_label_train_whole']},
                'dev_hdf': { 'class': 'HDFDataset',
                             'files': [ '/u/jxu/setups/switchboard/2021-10-10-swb-conformer-further-work/output/config/dataset/config_dump_sprint_to_hdf/sprint_dev_shuffled.hdf']},
                'gender_label': { 'class': 'HDFDataset',
                                  'files': ['/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/gender_label_train_whole']},
                'speaker_label_dev': { 'class': 'HDFDataset',
                                       'files': [ '/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/speaker_label_dev/speaker_label_train_whole']}},
  'seq_order_control_dataset': 'dev_hdf'}
device = 'gpu'
dropout = 0.1
gradient_clip = 0
gradient_noise = 0.0
learning_rate = 0.0002
learning_rate_control = 'newbob_multi_epoch'
learning_rate_control_error_measure = 'dev_error_spk_output'
learning_rate_control_min_num_epochs_per_new_lr = 6
learning_rate_control_relative_error_relative_lr = True
learning_rate_file = 'learning_rates'
log = ['./crnn.log']
log_verbosity = 3
model = '/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/work/jxu/crnn/sprint_training_meta_dataset_shuffled/CRNNSprintTrainingMetaDatasetShuffledJob.H9SXH1Pz02O5/output/models/epoch'
multiprocessing = True
nadam = True
network = { 'MLP_output': { 'activation': None,
                  'class': 'linear',
                  'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                  'from': 'masked_tconv',
                  'n_out': 384,
                  'trainable': False,
                  'with_bias': True},
  'aux_MLP_block_4': { 'activation': None,
                       'class': 'linear',
                       'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                       'from': 'aux_output_block_4',
                       'n_out': 384,
                       'trainable': False,
                       'with_bias': True},
  'aux_MLP_block_8': { 'activation': None,
                       'class': 'linear',
                       'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                       'from': 'aux_output_block_8',
                       'n_out': 384,
                       'trainable': False,
                       'with_bias': True},
  'aux_output_block_4': {'class': 'copy', 'from': 'masked_tconv_4', 'trainable': False},
  'aux_output_block_4_ce': { 'class': 'softmax',
                             'dropout': 0.0,
                             'from': 'aux_MLP_block_4',
                             'loss': 'ce',
                             'loss_opts': {'focal_loss_factor': 2},
                             'loss_scale': 0.3,
                             'target': 'classes',
                             'trainable': False},
  'aux_output_block_8': {'class': 'copy', 'from': 'masked_tconv_8', 'trainable': False},
  'aux_output_block_8_ce': { 'class': 'softmax',
                             'dropout': 0.0,
                             'from': 'aux_MLP_block_8',
                             'loss': 'ce',
                             'loss_opts': {'focal_loss_factor': 2},
                             'loss_scale': 0.3,
                             'target': 'classes',
                             'trainable': False},
  'c1': {'class': 'conv', 'filter_size': (3, 3), 'from': 'source0', 'n_out': 32, 'padding': 'same', 'trainable': False, 'with_bias': True},
  'c2': { 'class': 'conv',
          'filter_size': (3, 3),
          'from': 'y4',
          'n_out': 32,
          'padding': 'same',
          'strides': (3, 1),
          'trainable': False,
          'with_bias': True},
  'c3': {'class': 'conv', 'filter_size': (3, 3), 'from': 'p1', 'n_out': 64, 'padding': 'same', 'trainable': False, 'with_bias': True},
  'c4': {'class': 'conv', 'filter_size': (3, 3), 'from': 'y3', 'n_out': 64, 'padding': 'same', 'trainable': False, 'with_bias': True},
  'conformer_block_01': {'class': 'copy', 'from': 'conformer_block_01_ln', 'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_01_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_01_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_01_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_01_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_01_ffmod_1_res', 'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_01_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_01_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_01_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_01_covmod_1_conv_mod_half_step', 'conformer_block_01_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_01_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_01_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_01_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_01_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_01_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_01_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_01_self_att_res', 'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_01_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_01_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_01_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_01_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_01_covmod_2_conv_mod_half_step', 'conformer_block_01_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_01_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_01_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_01_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_01_ffmod_1_swish', 'trainable': False},
  'conformer_block_01_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_01_ffmod_1_ff2', 'trainable': False},
  'conformer_block_01_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_01_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_01_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_01_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_01_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_01_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_01_ffmod_1_ln': {'class': 'layer_norm', 'from': 'source_dropout', 'trainable': False},
  'conformer_block_01_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_01_ffmod_1_half_step', 'source_dropout'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_01_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_01_ffmod_1_ff1', 'trainable': False},
  'conformer_block_01_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_01_ffmod_2_swish', 'trainable': False},
  'conformer_block_01_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_01_ffmod_2_ff2', 'trainable': False},
  'conformer_block_01_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_01_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_01_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_01_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_01_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_01_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_01_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_01_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_01_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_01_ffmod_2_half_step', 'conformer_block_01_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_01_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_01_ffmod_2_ff1', 'trainable': False},
  'conformer_block_01_ln': {'class': 'layer_norm', 'from': 'conformer_block_01_ffmod_2_res', 'trainable': False},
  'conformer_block_01_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_01_self_att_ln',
                                   'key_shift': 'conformer_block_01_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_01_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_01_self_att_linear', 'trainable': False},
  'conformer_block_01_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_01_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_01_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_01_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_01_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_01_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_01_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_01_self_att_dropout', 'conformer_block_01_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_02': {'class': 'copy', 'from': 'conformer_block_02_ln', 'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_02_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_02_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_02_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_02_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_02_ffmod_1_res', 'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_02_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_02_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_02_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_02_covmod_1_conv_mod_half_step', 'conformer_block_02_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_02_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_02_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_02_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_02_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_02_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_02_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_02_self_att_res', 'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_02_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_02_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_02_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_02_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_02_covmod_2_conv_mod_half_step', 'conformer_block_02_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_02_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_02_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_02_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_02_ffmod_1_swish', 'trainable': False},
  'conformer_block_02_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_02_ffmod_1_ff2', 'trainable': False},
  'conformer_block_02_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_02_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_02_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_02_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_02_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_02_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_02_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_01', 'trainable': False},
  'conformer_block_02_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_02_ffmod_1_half_step', 'conformer_block_01'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_02_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_02_ffmod_1_ff1', 'trainable': False},
  'conformer_block_02_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_02_ffmod_2_swish', 'trainable': False},
  'conformer_block_02_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_02_ffmod_2_ff2', 'trainable': False},
  'conformer_block_02_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_02_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_02_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_02_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_02_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_02_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_02_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_02_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_02_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_02_ffmod_2_half_step', 'conformer_block_02_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_02_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_02_ffmod_2_ff1', 'trainable': False},
  'conformer_block_02_ln': {'class': 'layer_norm', 'from': 'conformer_block_02_ffmod_2_res', 'trainable': False},
  'conformer_block_02_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_02_self_att_ln',
                                   'key_shift': 'conformer_block_02_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_02_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_02_self_att_linear', 'trainable': False},
  'conformer_block_02_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_02_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_02_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_02_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_02_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_02_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_02_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_02_self_att_dropout', 'conformer_block_02_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_03': {'class': 'copy', 'from': 'conformer_block_03_ln', 'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_03_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_03_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_03_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_03_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_03_ffmod_1_res', 'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_03_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_03_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_03_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_03_covmod_1_conv_mod_half_step', 'conformer_block_03_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_03_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_03_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_03_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_03_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_03_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_03_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_03_self_att_res', 'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_03_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_03_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_03_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_03_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_03_covmod_2_conv_mod_half_step', 'conformer_block_03_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_03_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_03_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_03_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_03_ffmod_1_swish', 'trainable': False},
  'conformer_block_03_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_03_ffmod_1_ff2', 'trainable': False},
  'conformer_block_03_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_03_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_03_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_03_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_03_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_03_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_03_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_02', 'trainable': False},
  'conformer_block_03_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_03_ffmod_1_half_step', 'conformer_block_02'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_03_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_03_ffmod_1_ff1', 'trainable': False},
  'conformer_block_03_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_03_ffmod_2_swish', 'trainable': False},
  'conformer_block_03_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_03_ffmod_2_ff2', 'trainable': False},
  'conformer_block_03_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_03_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_03_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_03_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_03_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_03_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_03_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_03_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_03_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_03_ffmod_2_half_step', 'conformer_block_03_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_03_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_03_ffmod_2_ff1', 'trainable': False},
  'conformer_block_03_ln': {'class': 'layer_norm', 'from': 'conformer_block_03_ffmod_2_res', 'trainable': False},
  'conformer_block_03_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_03_self_att_ln',
                                   'key_shift': 'conformer_block_03_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_03_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_03_self_att_linear', 'trainable': False},
  'conformer_block_03_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_03_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_03_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_03_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_03_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_03_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_03_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_03_self_att_dropout', 'conformer_block_03_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_04': {'class': 'copy', 'from': 'conformer_block_04_ln', 'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_04_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_04_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_04_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_04_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_04_ffmod_1_res', 'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_04_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_04_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_04_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_04_covmod_1_conv_mod_half_step', 'conformer_block_04_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_04_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_04_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_04_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_04_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_04_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_04_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_04_self_att_res', 'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_04_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_04_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_04_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_04_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_04_covmod_2_conv_mod_half_step', 'conformer_block_04_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_04_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_04_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_04_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_04_ffmod_1_swish', 'trainable': False},
  'conformer_block_04_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_04_ffmod_1_ff2', 'trainable': False},
  'conformer_block_04_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_04_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_04_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_04_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_04_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_04_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_04_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_03', 'trainable': False},
  'conformer_block_04_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_04_ffmod_1_half_step', 'conformer_block_03'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_04_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_04_ffmod_1_ff1', 'trainable': False},
  'conformer_block_04_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_04_ffmod_2_swish', 'trainable': False},
  'conformer_block_04_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_04_ffmod_2_ff2', 'trainable': False},
  'conformer_block_04_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_04_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_04_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_04_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_04_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_04_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_04_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_04_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_04_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_04_ffmod_2_half_step', 'conformer_block_04_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_04_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_04_ffmod_2_ff1', 'trainable': False},
  'conformer_block_04_ln': {'class': 'layer_norm', 'from': 'conformer_block_04_ffmod_2_res', 'trainable': False},
  'conformer_block_04_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_04_self_att_ln',
                                   'key_shift': 'conformer_block_04_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_04_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_04_self_att_linear', 'trainable': False},
  'conformer_block_04_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_04_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_04_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_04_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_04_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_04_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_04_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_04_self_att_dropout', 'conformer_block_04_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_05': {'class': 'copy', 'from': 'conformer_block_05_ln', 'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_05_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_05_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_05_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_05_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_05_ffmod_1_res', 'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_05_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_05_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_05_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_05_covmod_1_conv_mod_half_step', 'conformer_block_05_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_05_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_05_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_05_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_05_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_05_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_05_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_05_self_att_res', 'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_05_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_05_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_05_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_05_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_05_covmod_2_conv_mod_half_step', 'conformer_block_05_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_05_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_05_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_05_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_05_ffmod_1_swish', 'trainable': False},
  'conformer_block_05_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_05_ffmod_1_ff2', 'trainable': False},
  'conformer_block_05_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_05_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_05_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_05_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_05_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_05_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_05_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_04', 'trainable': False},
  'conformer_block_05_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_05_ffmod_1_half_step', 'conformer_block_04'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_05_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_05_ffmod_1_ff1', 'trainable': False},
  'conformer_block_05_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_05_ffmod_2_swish', 'trainable': False},
  'conformer_block_05_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_05_ffmod_2_ff2', 'trainable': False},
  'conformer_block_05_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_05_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_05_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_05_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_05_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_05_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_05_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_05_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_05_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_05_ffmod_2_half_step', 'conformer_block_05_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_05_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_05_ffmod_2_ff1', 'trainable': False},
  'conformer_block_05_ln': {'class': 'layer_norm', 'from': 'conformer_block_05_ffmod_2_res', 'trainable': False},
  'conformer_block_05_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_05_self_att_ln',
                                   'key_shift': 'conformer_block_05_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_05_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_05_self_att_linear', 'trainable': False},
  'conformer_block_05_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_05_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_05_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_05_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_05_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_05_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_05_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_05_self_att_dropout', 'conformer_block_05_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_06': {'class': 'copy', 'from': 'conformer_block_06_ln', 'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_06_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_06_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_06_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_06_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_06_ffmod_1_res', 'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_06_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_06_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_06_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_06_covmod_1_conv_mod_half_step', 'conformer_block_06_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_06_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_06_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_06_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_06_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_06_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_06_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_06_self_att_res', 'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_06_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_06_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_06_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_06_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_06_covmod_2_conv_mod_half_step', 'conformer_block_06_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_06_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_06_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_06_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_06_ffmod_1_swish', 'trainable': False},
  'conformer_block_06_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_06_ffmod_1_ff2', 'trainable': False},
  'conformer_block_06_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_06_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_06_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_06_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_06_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_06_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_06_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_05', 'trainable': False},
  'conformer_block_06_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_06_ffmod_1_half_step', 'conformer_block_05'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_06_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_06_ffmod_1_ff1', 'trainable': False},
  'conformer_block_06_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_06_ffmod_2_swish', 'trainable': False},
  'conformer_block_06_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_06_ffmod_2_ff2', 'trainable': False},
  'conformer_block_06_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_06_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_06_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_06_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_06_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_06_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_06_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_06_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_06_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_06_ffmod_2_half_step', 'conformer_block_06_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_06_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_06_ffmod_2_ff1', 'trainable': False},
  'conformer_block_06_ln': {'class': 'layer_norm', 'from': 'conformer_block_06_ffmod_2_res', 'trainable': False},
  'conformer_block_06_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_06_self_att_ln',
                                   'key_shift': 'conformer_block_06_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_06_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_06_self_att_linear', 'trainable': False},
  'conformer_block_06_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_06_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_06_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_06_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_06_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_06_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_06_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_06_self_att_dropout', 'conformer_block_06_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_07': {'class': 'copy', 'from': 'conformer_block_07_ln', 'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_07_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_07_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_07_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_07_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_07_ffmod_1_res', 'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_07_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_07_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_07_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_07_covmod_1_conv_mod_half_step', 'conformer_block_07_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_07_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_07_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_07_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_07_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_07_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_07_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_07_self_att_res', 'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_07_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_07_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_07_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_07_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_07_covmod_2_conv_mod_half_step', 'conformer_block_07_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_07_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_07_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_07_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_07_ffmod_1_swish', 'trainable': False},
  'conformer_block_07_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_07_ffmod_1_ff2', 'trainable': False},
  'conformer_block_07_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_07_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_07_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_07_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_07_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_07_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_07_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_06', 'trainable': False},
  'conformer_block_07_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_07_ffmod_1_half_step', 'conformer_block_06'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_07_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_07_ffmod_1_ff1', 'trainable': False},
  'conformer_block_07_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_07_ffmod_2_swish', 'trainable': False},
  'conformer_block_07_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_07_ffmod_2_ff2', 'trainable': False},
  'conformer_block_07_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_07_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_07_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_07_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_07_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_07_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_07_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_07_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_07_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_07_ffmod_2_half_step', 'conformer_block_07_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_07_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_07_ffmod_2_ff1', 'trainable': False},
  'conformer_block_07_ln': {'class': 'layer_norm', 'from': 'conformer_block_07_ffmod_2_res', 'trainable': False},
  'conformer_block_07_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_07_self_att_ln',
                                   'key_shift': 'conformer_block_07_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_07_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_07_self_att_linear', 'trainable': False},
  'conformer_block_07_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_07_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_07_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_07_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_07_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_07_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_07_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_07_self_att_dropout', 'conformer_block_07_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_08': {'class': 'copy', 'from': 'conformer_block_08_ln', 'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_08_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_08_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_08_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_08_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_08_ffmod_1_res', 'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_08_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_08_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_08_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_08_covmod_1_conv_mod_half_step', 'conformer_block_08_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_08_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_08_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_08_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_08_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_08_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_08_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_08_self_att_res', 'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_08_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_08_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_08_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_08_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_08_covmod_2_conv_mod_half_step', 'conformer_block_08_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_08_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_08_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_08_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_08_ffmod_1_swish', 'trainable': False},
  'conformer_block_08_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_08_ffmod_1_ff2', 'trainable': False},
  'conformer_block_08_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_08_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_08_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_08_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_08_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_08_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_08_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_07', 'trainable': False},
  'conformer_block_08_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_08_ffmod_1_half_step', 'conformer_block_07'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_08_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_08_ffmod_1_ff1', 'trainable': False},
  'conformer_block_08_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_08_ffmod_2_swish', 'trainable': False},
  'conformer_block_08_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_08_ffmod_2_ff2', 'trainable': False},
  'conformer_block_08_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_08_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_08_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_08_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_08_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_08_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_08_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_08_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_08_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_08_ffmod_2_half_step', 'conformer_block_08_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_08_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_08_ffmod_2_ff1', 'trainable': False},
  'conformer_block_08_ln': {'class': 'layer_norm', 'from': 'conformer_block_08_ffmod_2_res', 'trainable': False},
  'conformer_block_08_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_08_self_att_ln',
                                   'key_shift': 'conformer_block_08_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_08_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_08_self_att_linear', 'trainable': False},
  'conformer_block_08_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_08_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_08_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_08_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_08_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_08_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_08_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_08_self_att_dropout', 'conformer_block_08_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_09': {'class': 'copy', 'from': 'conformer_block_09_ln', 'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_09_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_09_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_09_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_09_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_09_ffmod_1_res', 'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_09_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_09_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_09_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_09_covmod_1_conv_mod_half_step', 'conformer_block_09_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_09_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_09_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_09_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_09_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_09_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_09_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_09_self_att_res', 'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_09_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_09_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_09_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_09_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_09_covmod_2_conv_mod_half_step', 'conformer_block_09_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_09_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_09_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_09_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_09_ffmod_1_swish', 'trainable': False},
  'conformer_block_09_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_09_ffmod_1_ff2', 'trainable': False},
  'conformer_block_09_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_09_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_09_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_09_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_09_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_09_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_09_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_08', 'trainable': False},
  'conformer_block_09_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_09_ffmod_1_half_step', 'conformer_block_08'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_09_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_09_ffmod_1_ff1', 'trainable': False},
  'conformer_block_09_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_09_ffmod_2_swish', 'trainable': False},
  'conformer_block_09_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_09_ffmod_2_ff2', 'trainable': False},
  'conformer_block_09_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_09_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_09_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_09_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_09_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_09_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_09_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_09_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_09_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_09_ffmod_2_half_step', 'conformer_block_09_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_09_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_09_ffmod_2_ff1', 'trainable': False},
  'conformer_block_09_ln': {'class': 'layer_norm', 'from': 'conformer_block_09_ffmod_2_res', 'trainable': False},
  'conformer_block_09_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_09_self_att_ln',
                                   'key_shift': 'conformer_block_09_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_09_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_09_self_att_linear', 'trainable': False},
  'conformer_block_09_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_09_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_09_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_09_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_09_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_09_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_09_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_09_self_att_dropout', 'conformer_block_09_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_10': {'class': 'copy', 'from': 'conformer_block_10_ln', 'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_10_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_10_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_10_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_10_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_10_ffmod_1_res', 'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_10_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_10_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_10_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_10_covmod_1_conv_mod_half_step', 'conformer_block_10_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_10_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_10_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_10_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_10_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_10_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_10_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_10_self_att_res', 'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_10_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_10_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_10_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_10_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_10_covmod_2_conv_mod_half_step', 'conformer_block_10_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_10_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_10_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_10_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_10_ffmod_1_swish', 'trainable': False},
  'conformer_block_10_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_10_ffmod_1_ff2', 'trainable': False},
  'conformer_block_10_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_10_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_10_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_10_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_10_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_10_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_10_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_09', 'trainable': False},
  'conformer_block_10_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_10_ffmod_1_half_step', 'conformer_block_09'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_10_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_10_ffmod_1_ff1', 'trainable': False},
  'conformer_block_10_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_10_ffmod_2_swish', 'trainable': False},
  'conformer_block_10_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_10_ffmod_2_ff2', 'trainable': False},
  'conformer_block_10_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_10_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_10_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_10_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_10_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_10_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_10_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_10_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_10_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_10_ffmod_2_half_step', 'conformer_block_10_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_10_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_10_ffmod_2_ff1', 'trainable': False},
  'conformer_block_10_ln': {'class': 'layer_norm', 'from': 'conformer_block_10_ffmod_2_res', 'trainable': False},
  'conformer_block_10_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_10_self_att_ln',
                                   'key_shift': 'conformer_block_10_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_10_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_10_self_att_linear', 'trainable': False},
  'conformer_block_10_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_10_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_10_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_10_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_10_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_10_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_10_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_10_self_att_dropout', 'conformer_block_10_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_11': {'class': 'copy', 'from': 'conformer_block_11_ln', 'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_11_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_11_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_11_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_11_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_11_ffmod_1_res', 'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_11_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_11_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_11_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_11_covmod_1_conv_mod_half_step', 'conformer_block_11_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_11_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_11_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_11_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_11_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_11_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_11_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_11_self_att_res', 'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_11_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_11_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_11_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_11_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_11_covmod_2_conv_mod_half_step', 'conformer_block_11_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_11_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_11_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_11_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_11_ffmod_1_swish', 'trainable': False},
  'conformer_block_11_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_11_ffmod_1_ff2', 'trainable': False},
  'conformer_block_11_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_11_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_11_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_11_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_11_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_11_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_11_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_10', 'trainable': False},
  'conformer_block_11_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_11_ffmod_1_half_step', 'conformer_block_10'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_11_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_11_ffmod_1_ff1', 'trainable': False},
  'conformer_block_11_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_11_ffmod_2_swish', 'trainable': False},
  'conformer_block_11_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_11_ffmod_2_ff2', 'trainable': False},
  'conformer_block_11_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_11_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_11_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_11_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_11_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_11_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_11_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_11_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_11_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_11_ffmod_2_half_step', 'conformer_block_11_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_11_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_11_ffmod_2_ff1', 'trainable': False},
  'conformer_block_11_ln': {'class': 'layer_norm', 'from': 'conformer_block_11_ffmod_2_res', 'trainable': False},
  'conformer_block_11_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_11_self_att_ln',
                                   'key_shift': 'conformer_block_11_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_11_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_11_self_att_linear', 'trainable': False},
  'conformer_block_11_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_11_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_11_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_11_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_11_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_11_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_11_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_11_self_att_dropout', 'conformer_block_11_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'conformer_block_12': {'class': 'copy', 'from': 'conformer_block_12_ln', 'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_12_covmod_1_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_1_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_12_covmod_1_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_12_covmod_1_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_12_covmod_1_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_12_ffmod_1_res', 'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_12_covmod_1_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_12_covmod_1_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_1_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_12_covmod_1_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_1_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_12_covmod_1_conv_mod_half_step', 'conformer_block_12_ffmod_1_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_12_covmod_1_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_12_covmod_1_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_depthwise_conv2': { 'activation': None,
                                                            'class': 'conv',
                                                            'filter_size': (8,),
                                                            'from': 'conformer_block_12_covmod_2_conv_mod_glu',
                                                            'groups': 384,
                                                            'n_out': 384,
                                                            'padding': 'same',
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_2_conv_mod_drop': { 'class': 'dropout',
                                                 'dropout': 0.1,
                                                 'from': 'conformer_block_12_covmod_2_conv_mod_pointwise_conv2',
                                                 'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_glu': { 'activation': 'identity',
                                                'class': 'gating',
                                                'from': 'conformer_block_12_covmod_2_conv_mod_pointwise_conv1',
                                                'gate_activation': 'sigmoid',
                                                'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_half_step': { 'class': 'eval',
                                                      'eval': '0.5 * source(0)',
                                                      'from': 'conformer_block_12_covmod_2_conv_mod_drop',
                                                      'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_ln': {'class': 'layer_norm', 'from': 'conformer_block_12_self_att_res', 'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_ln_replace_bn': { 'class': 'layer_norm',
                                                          'from': 'conformer_block_12_covmod_2_conv_mod_depthwise_conv2',
                                                          'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_pointwise_conv1': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_12_covmod_2_conv_mod_ln',
                                                            'n_out': 768,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_2_conv_mod_pointwise_conv2': { 'activation': None,
                                                            'class': 'linear',
                                                            'forward_weights_init': { 'class': 'VarianceScaling',
                                                                                      'distribution': 'uniform',
                                                                                      'mode': 'fan_in',
                                                                                      'scale': 0.78},
                                                            'from': 'conformer_block_12_covmod_2_conv_mod_swish',
                                                            'n_out': 384,
                                                            'trainable': False,
                                                            'with_bias': True},
  'conformer_block_12_covmod_2_conv_mod_res': { 'class': 'combine',
                                                'from': ['conformer_block_12_covmod_2_conv_mod_half_step', 'conformer_block_12_self_att_res'],
                                                'kind': 'add',
                                                'n_out': 384,
                                                'trainable': False},
  'conformer_block_12_covmod_2_conv_mod_swish': { 'activation': 'swish',
                                                  'class': 'activation',
                                                  'from': 'conformer_block_12_covmod_2_conv_mod_ln_replace_bn',
                                                  'trainable': False},
  'conformer_block_12_ffmod_1_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_12_ffmod_1_swish', 'trainable': False},
  'conformer_block_12_ffmod_1_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_12_ffmod_1_ff2', 'trainable': False},
  'conformer_block_12_ffmod_1_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_12_ffmod_1_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_12_ffmod_1_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_12_ffmod_1_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_12_ffmod_1_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_12_ffmod_1_drop2',
                                            'trainable': False},
  'conformer_block_12_ffmod_1_ln': {'class': 'layer_norm', 'from': 'conformer_block_11', 'trainable': False},
  'conformer_block_12_ffmod_1_res': { 'class': 'combine',
                                      'from': ['conformer_block_12_ffmod_1_half_step', 'conformer_block_11'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_12_ffmod_1_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_12_ffmod_1_ff1', 'trainable': False},
  'conformer_block_12_ffmod_2_drop1': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_12_ffmod_2_swish', 'trainable': False},
  'conformer_block_12_ffmod_2_drop2': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_12_ffmod_2_ff2', 'trainable': False},
  'conformer_block_12_ffmod_2_ff1': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_12_ffmod_2_ln',
                                      'n_out': 1536,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_12_ffmod_2_ff2': { 'activation': None,
                                      'class': 'linear',
                                      'forward_weights_init': { 'class': 'VarianceScaling',
                                                                'distribution': 'uniform',
                                                                'mode': 'fan_in',
                                                                'scale': 0.78},
                                      'from': 'conformer_block_12_ffmod_2_drop1',
                                      'n_out': 384,
                                      'trainable': False,
                                      'with_bias': True},
  'conformer_block_12_ffmod_2_half_step': { 'class': 'eval',
                                            'eval': '0.5 * source(0)',
                                            'from': 'conformer_block_12_ffmod_2_drop2',
                                            'trainable': False},
  'conformer_block_12_ffmod_2_ln': {'class': 'layer_norm', 'from': 'conformer_block_12_covmod_2_conv_mod_res', 'trainable': False},
  'conformer_block_12_ffmod_2_res': { 'class': 'combine',
                                      'from': ['conformer_block_12_ffmod_2_half_step', 'conformer_block_12_covmod_2_conv_mod_res'],
                                      'kind': 'add',
                                      'n_out': 384,
                                      'trainable': False},
  'conformer_block_12_ffmod_2_swish': {'activation': 'swish', 'class': 'activation', 'from': 'conformer_block_12_ffmod_2_ff1', 'trainable': False},
  'conformer_block_12_ln': {'class': 'layer_norm', 'from': 'conformer_block_12_ffmod_2_res', 'trainable': False},
  'conformer_block_12_self_att': { 'attention_dropout': 0.1,
                                   'class': 'self_attention',
                                   'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                                   'from': 'conformer_block_12_self_att_ln',
                                   'key_shift': 'conformer_block_12_self_att_ln_rel_pos_enc',
                                   'n_out': 384,
                                   'num_heads': 6,
                                   'total_key_dim': 384,
                                   'trainable': False},
  'conformer_block_12_self_att_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'conformer_block_12_self_att_linear', 'trainable': False},
  'conformer_block_12_self_att_linear': { 'activation': None,
                                          'class': 'linear',
                                          'forward_weights_init': { 'class': 'VarianceScaling',
                                                                    'distribution': 'uniform',
                                                                    'mode': 'fan_in',
                                                                    'scale': 0.78},
                                          'from': 'conformer_block_12_self_att',
                                          'n_out': 384,
                                          'trainable': False,
                                          'with_bias': False},
  'conformer_block_12_self_att_ln': {'class': 'layer_norm', 'from': 'conformer_block_12_covmod_1_conv_mod_res', 'trainable': False},
  'conformer_block_12_self_att_ln_rel_pos_enc': { 'class': 'relative_positional_encoding',
                                                  'forward_weights_init': { 'class': 'VarianceScaling',
                                                                            'distribution': 'uniform',
                                                                            'mode': 'fan_in',
                                                                            'scale': 0.78},
                                                  'from': 'conformer_block_12_self_att_ln',
                                                  'n_out': 64,
                                                  'trainable': False},
  'conformer_block_12_self_att_res': { 'class': 'combine',
                                       'from': ['conformer_block_12_self_att_dropout', 'conformer_block_12_covmod_1_conv_mod_res'],
                                       'kind': 'add',
                                       'n_out': 384,
                                       'trainable': False},
  'encoder': {'class': 'copy', 'from': 'conformer_block_12', 'trainable': False},
  'masked_tconv': {'class': 'reinterpret_data', 'from': 'transposedconv', 'size_base': 'data:classes', 'trainable': False},
  'masked_tconv_4': {'class': 'reinterpret_data', 'from': 'transposedconv_4', 'size_base': 'data:classes', 'trainable': False},
  'masked_tconv_8': {'class': 'reinterpret_data', 'from': 'transposedconv_8', 'size_base': 'data:classes', 'trainable': False},
  'output': { 'class': 'softmax',
              'dropout': 0.0,
              'from': 'MLP_output',
              'loss': 'ce',
              'loss_opts': {'focal_loss_factor': 2},
              'loss_scale': 1,
              'target': 'classes',
              'trainable': False},
  'p1': {'class': 'pool', 'from': 'y1', 'mode': 'max', 'padding': 'same', 'pool_size': (1, 2), 'trainable': False},
  'p2': {'class': 'pool', 'from': 'y4', 'mode': 'max', 'padding': 'same', 'pool_size': (1, 2), 'trainable': False},
  'source': { 'class': 'eval',
              'eval': "self.network.get_config().typed_value('transform')(source(0, as_data=True), network=self.network)",
              'from': 'data',
              'trainable': False},
  'source0': {'axis': 'F', 'class': 'split_dims', 'dims': (-1, 1), 'from': 'source', 'trainable': False},
  'source_dropout': {'class': 'dropout', 'dropout': 0.1, 'from': 'source_linear_ln', 'trainable': False},
  'source_linear': { 'activation': None,
                     'class': 'linear',
                     'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                     'from': 'vgg_conv_merged',
                     'n_out': 384,
                     'trainable': False,
                     'with_bias': False},
  'source_linear_ln': {'class': 'layer_norm', 'from': 'source_linear', 'trainable': False},
  'speaker_label_notime': {'axis': 'T', 'class': 'squeeze', 'from': ['data:speaker_label'], 'register_as_extern_data': 'speaker_label_notime'},
  'spk_loss_reverse_gradient': {'class': 'copy', 'from': 'conformer_block_01_ffmod_2_res'},
  'spk_output': { 'class': 'softmax',
                  'dropout': 0.0,
                  'from': 'spk_vec_ff',
                  'loss': 'ce',
                  'loss_opts': {},
                  'loss_scale': 1,
                  'target': 'speaker_label_notime'},
  'spk_summary_att_W': { 'activation': 'tanh',
                         'class': 'linear',
                         'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                         'from': 'spk_summary_att_ff',
                         'n_out': 384,
                         'with_bias': True},
  'spk_summary_att_context': { 'auto_squeeze': False,
                               'base': 'conformer_block_01_ffmod_2_res',
                               'class': 'generic_attention',
                               'weights': 'spk_summary_att_weights'},
  'spk_summary_att_e': { 'activation': None,
                         'class': 'linear',
                         'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                         'from': 'spk_summary_att_W',
                         'n_out': 1,
                         'with_bias': False},
  'spk_summary_att_ff': { 'activation': 'tanh',
                          'class': 'linear',
                          'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                          'from': 'spk_loss_reverse_gradient',
                          'n_out': 384,
                          'with_bias': True},
  'spk_summary_att_weights': {'class': 'softmax_over_spatial', 'from': 'spk_summary_att_e'},
  'spk_vec': {'axes': 'except_batch', 'class': 'merge_dims', 'from': ['spk_summary_att_context']},
  'spk_vec_ff': { 'activation': None,
                  'class': 'linear',
                  'forward_weights_init': {'class': 'VarianceScaling', 'distribution': 'uniform', 'mode': 'fan_in', 'scale': 0.78},
                  'from': 'spk_vec',
                  'n_out': 768,
                  'with_bias': True},
  'transposedconv': { 'L2': 0.01,
                      'activation': 'swish',
                      'class': 'transposed_conv',
                      'dropout': 0.1,
                      'filter_size': [3],
                      'from': 'encoder',
                      'n_out': 512,
                      'strides': [3],
                      'trainable': False},
  'transposedconv_4': { 'L2': 0.01,
                        'activation': 'swish',
                        'class': 'transposed_conv',
                        'dropout': 0.1,
                        'filter_size': [3],
                        'from': 'conformer_block_04',
                        'n_out': 512,
                        'reuse_params': 'transposedconv',
                        'strides': [3],
                        'trainable': False},
  'transposedconv_8': { 'L2': 0.01,
                        'activation': 'swish',
                        'class': 'transposed_conv',
                        'dropout': 0.1,
                        'filter_size': [3],
                        'from': 'conformer_block_08',
                        'n_out': 512,
                        'reuse_params': 'transposedconv',
                        'strides': [3],
                        'trainable': False},
  'vgg_conv_merged': {'axes': 'static', 'class': 'merge_dims', 'from': 'y2', 'trainable': False},
  'y1': {'activation': 'swish', 'batch_norm': False, 'class': 'activation', 'from': 'c1', 'trainable': False},
  'y2': {'activation': 'swish', 'batch_norm': False, 'class': 'activation', 'from': 'c2', 'trainable': False},
  'y3': {'activation': 'swish', 'batch_norm': False, 'class': 'activation', 'from': 'c3', 'trainable': False},
  'y4': {'activation': 'swish', 'batch_norm': False, 'class': 'activation', 'from': 'c4', 'trainable': False}}
newbob_learning_rate_decay = 0.9
newbob_multi_num_epochs = 3
newbob_multi_update_interval = 1
num_blocks = 12
num_epochs = 150
num_outputs = {'classes': [9001, 1], 'data': [40, 2], 'speaker_label': [520, 1]}
optimizer_epsilon = 1e-08
partition_epochs = {'dev': 1, 'train': 6}
preload_from_files = { 'am': { 'filename': '/u/jxu/setups/switchboard/2021-10-10-swb-conformer-further-work/work/jxu/crnn/sprint_training/do_not_delete/baseline_WER_10_7/CRNNSprintTrainingJob.rnZyHfvWvwTv/output/models/epoch.170',
          'ignore_missing': True,
          'init_for_train': True,
          'prefix': ''}}
save_interval = 2
start_batch = 'auto'
start_epoch = 'auto'
target = 'classes'
task = 'train'
tf_log_memory_usage = True
train = { 'class': 'MetaDataset',
  'data_map': { 'accent_label': ('accent_label', 'data'),
                'classes': ('train_hdf', 'classes'),
                'data': ('train_hdf', 'data'),
                'gender_label': ('gender_label', 'data'),
                'speaker_label': ('speaker_label', 'data')},
  'datasets': { 'accent_label': { 'class': 'HDFDataset',
                                  'files': ['/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/accent_label_train_whole']},
                'gender_label': { 'class': 'HDFDataset',
                                  'files': ['/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/gender_label_train_whole']},
                'speaker_label': { 'class': 'HDFDataset',
                                   'files': [ '/u/jxu/setups/switchboard/2022-01-11--conformer-ivector/output/speaker_label_dev/speaker_label_train_whole']},
                'train_hdf': { 'class': 'HDFDataset',
                               'files': [ '/u/jxu/setups/switchboard/2021-10-10-swb-conformer-further-work/output/config/dataset/config_dump_sprint_to_hdf/sprint_train_shuffled.hdf'],
                               'partition_epoch': 6,
                               'seq_ordering': 'random'}},
  'seq_order_control_dataset': 'train_hdf'}
truncation = -1
update_on_device = True
use_tensorflow = True
window = 1
config = {}

locals().update(**config)

import sys
sys.setrecursionlimit(3000)
